<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>BioRadio 150 DLL: Example Program</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.2 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="headertitle">
<h1>Example Program </h1>  </div>
</div>
<div class="contents">
<h2><a class="anchor" id="Header"></a>
 </h2>
<p>This example program is intended to be compiled and run using Borland RAD Studio. Use with other compilers may be possible with some modifications.</p>
<h2><a class="anchor" id="exampleCode"></a>
 </h2>
<div class="fragment"><pre class="fragment"><span class="comment">//---------------------------------------------------------------------------</span>
<span class="preprocessor">#include &lt;vcl.h&gt;</span>
<span class="preprocessor">#include &lt;iostream.h&gt;</span>
<span class="preprocessor">#include &lt;conio.h&gt;</span>  
<span class="preprocessor">#include &lt;values.h&gt;</span>

<span class="preprocessor">#include &quot;<a class="code" href="_bio_radio150_d_l_l_8h.html">BioRadio150DLL.h</a>&quot;</span>

<span class="preprocessor">#pragma hdrstop</span>
<span class="preprocessor"></span><span class="preprocessor">#pragma argsused</span>
<span class="preprocessor"></span>
<span class="keywordtype">int</span> main(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span>* argv[])
{
  <span class="keywordtype">char</span> *configFilePath = <span class="stringliteral">&quot;C:\\CleveMed\\TestBioRadioConfig.ini&quot;</span>;
  <span class="keyword">const</span> <span class="keywordtype">int</span> FAST_INPUTS_BUFFER_SIZE = 20000;
  <span class="keyword">const</span> <span class="keywordtype">int</span> SLOW_INPUTS_BUFFER_SIZE = 10000;
  <span class="keyword">const</span> <span class="keywordtype">int</span> ACQUISITION_INTERVAL = 50; <span class="comment">// (milliseconds)</span>

  <span class="comment">/* FIND DEVICES */</span>
  <span class="keyword">const</span> <span class="keywordtype">int</span> MAX_DEVICES = 10;
  <a class="code" href="_bio_radio150_d_l_l_8h.html#a00d4f309c7e8028871506f3d3f7532ac">TUpdateStatusEvent</a> <a class="code" href="_bio_radio150_d_l_l_8h.html#a0503c85d1deea29fd1eaf373410747ef">UpdateStatusFunc</a> = NULL;
  <span class="keywordtype">char</span> *portName;
        <span class="keywordtype">int</span> deviceCount = 0;
  <a class="code" href="struct_t_device_info.html">TDeviceInfo</a> DeviceList[MAX_DEVICES];
  cout &lt;&lt; <span class="stringliteral">&quot;Searching for BioRadio 150 Computer Units...&quot;</span> &lt;&lt; endl;
        <a class="code" href="_bio_radio150_d_l_l_8h.html#aa2e8668ea02c1474f294c574d7178ed0">FindDevices</a>(DeviceList, &amp;deviceCount, MAX_DEVICES, UpdateStatusFunc);
  cout &lt;&lt; <span class="stringliteral">&quot;Found &quot;</span> &lt;&lt; deviceCount &lt;&lt; <span class="stringliteral">&quot; BioRadio 150 Computer Units:&quot;</span>;
  <span class="keywordflow">if</span> (deviceCount &gt; 0) {
                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;deviceCount; i++) {
                        cout &lt;&lt; ((i!=0) ? <span class="stringliteral">&quot;, &quot;</span> : <span class="stringliteral">&quot; &quot;</span>) &lt;&lt; DeviceList[i].<a class="code" href="struct_t_device_info.html#a603946bd16589dce7a09529059adfb91">PortName</a>;
    }
    portName = DeviceList[0].<a class="code" href="struct_t_device_info.html#a603946bd16589dce7a09529059adfb91">PortName</a>;
    cout &lt;&lt; endl &lt;&lt; <span class="stringliteral">&quot;Using &quot;</span> &lt;&lt; portName &lt;&lt; <span class="stringliteral">&quot;.&quot;</span> &lt;&lt; endl;
        } <span class="keywordflow">else</span> {
    cout &lt;&lt; <span class="stringliteral">&quot;Exiting.&quot;</span> &lt;&lt; endl;
        system(<span class="stringliteral">&quot;pause&quot;</span>);
        <span class="keywordflow">return</span> -1;
  }

  <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> devHandle;

  devHandle = <a class="code" href="group___create_destroy.html#gab2cb90980e07a4f86f5d078b04db9492">CreateBioRadio</a>();
  cout &lt;&lt; endl &lt;&lt; <span class="stringliteral">&quot;Create BioRadio Object... (&quot;</span> &lt;&lt; devHandle &lt;&lt; <span class="stringliteral">&quot;)&quot;</span> &lt;&lt; endl;

  <a class="code" href="group___acq.html#gac1d8f548691ceee2932a70e04d4f3cd7">SetBadDataValues</a>(devHandle, -65535, 65535);

  <span class="keywordflow">if</span> (devHandle&gt;0) {
        <span class="comment">/* START COMMUNICATION */</span>
    <span class="keywordtype">int</span> successFlag = <a class="code" href="group___start_stop.html#ga35e3f777938c9abee24b53b39fe78bf2">StartCommunication</a>(devHandle, portName);
    cout &lt;&lt; <span class="stringliteral">&quot;Start Comm... (&quot;</span> &lt;&lt; successFlag &lt;&lt; <span class="stringliteral">&quot;)&quot;</span> &lt;&lt; endl &lt;&lt; endl;
    <span class="keywordflow">if</span> (successFlag &gt; 0){
      <span class="comment">/* START ACQUISITION */</span>
            successFlag = <a class="code" href="group___start_stop.html#ga6590399f02fc04ed2df7afd0404be8ee">StartAcq</a>(devHandle, 1);
            cout &lt;&lt; <span class="stringliteral">&quot;Start Acq... (&quot;</span> &lt;&lt; successFlag &lt;&lt; <span class="stringliteral">&quot;)&quot;</span> &lt;&lt; endl;
            <span class="keywordflow">if</span> (successFlag &gt; 0){
        <span class="comment">/* PROGRAM CONFIGURATION */</span>
        successFlag = <a class="code" href="group___config.html#ga07eeb437d4ba506335c35888ca4a65ac">ProgramConfig</a>(devHandle, 1, configFilePath);
        cout &lt;&lt; <span class="stringliteral">&quot;Program Config... (&quot;</span> &lt;&lt; successFlag &lt;&lt; <span class="stringliteral">&quot;)\n&quot;</span> &lt;&lt; endl;
              <span class="keywordflow">if</span> (successFlag &gt; 0){
            <span class="keywordtype">int</span> numFastMainInputs, numFastAuxInputs, numSlowInputs;
          <span class="keywordtype">int</span> numTotalInputs = <a class="code" href="group___config.html#gac41144798858f150b9879c3d441debd7">GetNumEnabledInputs</a>(devHandle,
            &amp;numFastMainInputs, &amp;numFastAuxInputs, &amp;numSlowInputs);
            cout &lt;&lt; <span class="stringliteral">&quot;Inputs: &quot;</span> &lt;&lt; numFastMainInputs &lt;&lt; <span class="stringliteral">&quot; fast main, &quot;</span> &lt;&lt; numFastAuxInputs &lt;&lt;
            <span class="stringliteral">&quot; fast aux, &quot;</span> &lt;&lt; numSlowInputs &lt;&lt; <span class="stringliteral">&quot; slow, &quot;</span> &lt;&lt; numTotalInputs &lt;&lt; <span class="stringliteral">&quot; total&quot;</span> &lt;&lt; endl;
            cout &lt;&lt; <span class="stringliteral">&quot;Sample Rate = &quot;</span> &lt;&lt; <a class="code" href="group___config.html#gae97b4783f3f0fc1f4741d0f725522e82">GetSampleRate</a>(devHandle) &lt;&lt; endl;
        
            <span class="keywordtype">double</span> FastInputsData[FAST_INPUTS_BUFFER_SIZE];
            WORD SlowInputsData[SLOW_INPUTS_BUFFER_SIZE];
            <span class="keywordtype">int</span> FastInputsNumRead, SlowInputsNumRead, readReturn;
                                        <span class="keywordtype">int</span> statusCount = 0;

          <span class="keywordflow">while</span> (!kbhit()) {
                <span class="comment">/* REQUEST DATA EVERY 50MS UNTIL KEY PRESSED */</span>
            cout &lt;&lt; endl &lt;&lt; <span class="stringliteral">&quot;Tfr Buffer... (&quot;</span> &lt;&lt; <a class="code" href="group___acq.html#ga01f79f89e66cfc0d8df20d0e5052f7df">TransferBuffer</a>(devHandle) &lt;&lt; <span class="stringliteral">&quot;)&quot;</span> &lt;&lt; endl;
            readReturn = <a class="code" href="group___acq.html#gadec72dc14ef3e449ca5c43ad63523326">ReadScaledFastAndSlowData</a>(devHandle,
              FastInputsData, FAST_INPUTS_BUFFER_SIZE, &amp;FastInputsNumRead,
              SlowInputsData, SLOW_INPUTS_BUFFER_SIZE, &amp;SlowInputsNumRead);
            cout &lt;&lt; <span class="stringliteral">&quot;Read Data... (&quot;</span> &lt;&lt; readReturn &lt;&lt; <span class="stringliteral">&quot;)&quot;</span> &lt;&lt; endl;
            cout &lt;&lt; <span class="stringliteral">&quot;Fast Inputs Num Read = &quot;</span> &lt;&lt; FastInputsNumRead &lt;&lt; endl;
            cout &lt;&lt; <span class="stringliteral">&quot;Slow Inputs Num Read = &quot;</span> &lt;&lt; SlowInputsNumRead &lt;&lt; endl;
            <span class="keywordflow">if</span> (statusCount++ &gt;= 20) {
                statusCount = 0;
                cout &lt;&lt; endl;
              cout &lt;&lt; <span class="stringliteral">&quot;  BatteryStatus = &quot;</span> &lt;&lt; <a class="code" href="group___misc.html#ga3df1bf3bc4147975b7043c9c968dd9ce">GetBatteryStatus</a>(devHandle) &lt;&lt; endl;
                                                        cout &lt;&lt; <span class="stringliteral">&quot;  RSSI: &quot;</span> &lt;&lt; <a class="code" href="group___link.html#ga29b6746ec5c9fd269991f7da27f6cac8">GetUpRSSI</a>(devHandle) &lt;&lt; <span class="stringliteral">&quot; up / &quot;</span> &lt;&lt; <a class="code" href="group___link.html#ga784b72c420ac296250436d2a6b5e434a">GetDownRSSI</a>(devHandle) &lt;&lt; <span class="stringliteral">&quot; down&quot;</span> &lt;&lt; endl;
                                                        cout &lt;&lt; <span class="stringliteral">&quot;  BufSz: &quot;</span> &lt;&lt; <a class="code" href="group___link.html#gab60ae1253960f9ef714f479e20084299">GetLinkBufferSize</a>(devHandle) &lt;&lt; endl;
                                                        cout &lt;&lt; <span class="stringliteral">&quot;  BEC: &quot;</span> &lt;&lt; <a class="code" href="group___link.html#gadefc0b88d9bbf2bb1add37ba0b0cfead">GetBitErrCount</a>(devHandle) &lt;&lt; endl;
                                                        cout &lt;&lt; <span class="stringliteral">&quot;  BER: &quot;</span> &lt;&lt; <a class="code" href="group___link.html#ga8b750ddd6c7f91dd41bf4f3f72645396">GetBitErrRate</a>(devHandle) &lt;&lt; endl;
                                                        cout &lt;&lt; <span class="stringliteral">&quot;  Pkts: &quot;</span> &lt;&lt; <a class="code" href="group___link.html#ga723c2a3a026dd9bb8a171dc9a225d330">GetGoodPackets</a>(devHandle) &lt;&lt; <span class="stringliteral">&quot; good &quot;</span> &lt;&lt;
                                    <a class="code" href="group___link.html#ga9a958d7b3bbde36574342ba55004fea8">GetBadPackets</a>(devHandle) &lt;&lt; <span class="stringliteral">&quot; bad &quot;</span> &lt;&lt;
                                    <a class="code" href="group___link.html#ga6d61bcffb26aec79af35b0700baec398">GetDroppedPackets</a>(devHandle) &lt;&lt; <span class="stringliteral">&quot; dropped&quot;</span> &lt;&lt; endl;
            }
            Sleep(ACQUISITION_INTERVAL);
          }
              }
        <span class="comment">/* STOP ACQUISITION */</span>
              cout &lt;&lt; endl &lt;&lt; <span class="stringliteral">&quot;Stop Acq... (&quot;</span> &lt;&lt; <a class="code" href="group___start_stop.html#ga18ce2ea844cdab6360bd9bce301c99a8">StopAcq</a>(devHandle) &lt;&lt; <span class="stringliteral">&quot;)&quot;</span> &lt;&lt;  endl;
            }
      <span class="comment">/* STOP COMMUNICATION */</span>
      cout &lt;&lt; endl &lt;&lt; <span class="stringliteral">&quot;Stop Comm... (&quot;</span> &lt;&lt; <a class="code" href="group___start_stop.html#gad3533264f65482feb1c64cc59b7409dd">StopCommunication</a>(devHandle) &lt;&lt; <span class="stringliteral">&quot;)&quot;</span> &lt;&lt; endl;
    }
    successFlag = <a class="code" href="group___create_destroy.html#ga9c42addeed92bb0d642701607b19bbf8">DestroyBioRadio</a>(devHandle);
    cout &lt;&lt; <span class="stringliteral">&quot;Destroy BioRadio Object... (&quot;</span> &lt;&lt; successFlag &lt;&lt; <span class="stringliteral">&quot;)\n&quot;</span> &lt;&lt; endl;
  }
  
  system(<span class="stringliteral">&quot;pause&quot;</span>);
  <span class="keywordflow">return</span> 1;
}
<span class="comment">//---------------------------------------------------------------------------</span>
</pre></div> </div>
<hr class="footer"/><address class="footer"><small>Generated on Fri Mar 2 2012 11:23:54 for BioRadio 150 DLL by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.2 </small></address>
</body>
</html>
